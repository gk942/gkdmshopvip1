<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>N·∫°p ti·ªÅn</title>
  <script src="firebase.js"></script>
  <style>
    body { font-family: Arial; background: #f0f0f0; padding: 30px; }
    .container {
      background: white; padding: 20px; max-width: 450px;
      margin: auto; border-radius: 10px; box-shadow: 0 0 10px gray;
    }
    .btn { padding: 10px; background: #2196f3; color: white; border: none; width: 100%; border-radius: 6px; cursor: pointer; }
    .btn:hover { background: #0d8be0; }
    .qr-img { width: 100%; }
  </style>
</head>
<body>
  <div class="container">
    <h2>üí≥ N·∫°p ti·ªÅn v√†o t√†i kho·∫£n</h2>
    <p><strong>Ng√¢n h√†ng:</strong> MB Bank</p>
    <p><strong>S·ªë t√†i kho·∫£n:</strong> 0977049795</p>
    <p><strong>Ch·ªß t√†i kho·∫£n:</strong> Dinh Hong Hanh</p>
    <p><strong>N·ªôi dung chuy·ªÉn kho·∫£n:</strong> <span id="ndck"></span></p>
    <img class="qr-img" id="qr" src="" alt="QR Code">
    <br><br>
    <button class="btn" onclick="xacNhanNap()">üì§ T√¥i ƒë√£ chuy·ªÉn kho·∫£n</button>
    <p id="status"></p>
  </div>

  <script>
    const uid = localStorage.getItem('uid');
    if (!uid) {
      alert("B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p!");
      location.href = "loginkhach.html";
    }

    document.getElementById('ndck').innerText = uid;
    document.getElementById('qr').src = `https://img.vietqr.io/image/mb-0977049795-print.png?amount=0&addInfo=${uid}&accountName=Dinh%20Hong%20Hanh`;

    function xacNhanNap() {
      const time = new Date().toLocaleString();
      document.getElementById('status').innerText = "‚è≥ ƒêang g·ª≠i y√™u c·∫ßu...";

      database.ref("giaodich/" + uid).set({
        uid: uid,
        time: time,
        status: "ƒêang ch·ªù duy·ªát"
      }, (error) => {
        if (error) {
          document.getElementById('status').innerText = "‚ùå G·ª≠i th·∫•t b·∫°i!";
        } else {
          document.getElementById('status').innerText = "‚úÖ ƒê√£ g·ª≠i. Vui l√≤ng ch·ªù admin duy·ªát.";
        }
      });
    }
  </script>
</body>
</html>
