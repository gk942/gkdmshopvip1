<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>N·∫°p ti·ªÅn</title>
  <script src="firebase.js"></script>
  <style>
    body {
      background: #f1f5f9;
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    .box {
      background: white;
      padding: 20px;
      border-radius: 10px;
      max-width: 500px;
      margin: auto;
    }
    .btn {
      padding: 10px;
      background: #10b981;
      color: white;
      border: none;
      border-radius: 6px;
      width: 100%;
      margin-top: 10px;
      cursor: pointer;
    }
    #status {
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="box">
    <h2>üíµ N·∫°p ti·ªÅn qua MBBank</h2>
    <p><strong>S·ªë t√†i kho·∫£n:</strong> 0977049795</p>
    <p><strong>Ch·ªß t√†i kho·∫£n:</strong> Dinh Hong Hanh</p>
    <p><strong>N·ªôi dung chuy·ªÉn kho·∫£n:</strong> <span id="uidContent">UID1234</span></p>
    <img src="" id="qrImg" alt="QR code" width="100%">

    <button class="btn" onclick="xacNhan()">T√¥i ƒë√£ chuy·ªÉn kho·∫£n</button>
    <p id="status"></p>
  </div>

  <script>
    const uid = localStorage.getItem('user_uid');
    if (!uid) {
      alert("B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p!");
      window.location.href = "loginkhach.html";
    }

    document.getElementById('uidContent').innerText = uid;
    document.getElementById('qrImg').src = `https://img.vietqr.io/image/mb-0977049795-print.png?amount=0&addInfo=${uid}&accountName=Dinh%20Hong%20Hanh`;

    function xacNhan() {
      const now = new Date().toLocaleString();
      firebase.database().ref('giaodich/' + uid).set({
        uid: uid,
        time: now,
        status: "ƒêang ch·ªù duy·ªát"
      }, (err) => {
        document.getElementById('status').innerText = err ? "‚ùå Th·∫•t b·∫°i!" : "‚úÖ ƒê√£ g·ª≠i y√™u c·∫ßu ch·ªù duy·ªát!";
      });
    }
  </script>
</body>
</html>
