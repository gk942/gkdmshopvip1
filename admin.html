<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Admin Duyệt Giao Dịch</title>
  <script src="firebase.js"></script>
  <style>
    body { font-family: Arial; padding: 20px; background: #f0f2f5; }
    .box { background: white; padding: 20px; border-radius: 8px; max-width: 800px; margin: auto; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    h2 { margin-bottom: 20px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 10px; border: 1px solid #ccc; text-align: center; }
    button { padding: 5px 10px; background: green; color: white; border: none; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>
  <div class="box">
    <h2>Admin - Duyệt giao dịch</h2>
    <div id="banggiaodich">Đang tải...</div>
  </div>

  <script>
    const matkhau = prompt("Nhập mật khẩu admin:");
    if (matkhau !== "Maka26042006") {
      alert("Sai mật khẩu!");
      window.location.href = "index.html";
    }

    database.ref("giaodich").on("value", snapshot => {
      const data = snapshot.val();
      let html = "<table><tr><th>UID</th><th>Trạng thái</th><th>Hành động</th></tr>";
      for (let uid in data) {
        html += `<tr>
          <td>${uid}</td>
          <td>${data[uid].status}</td>
          <td>${data[uid].status === "Đang chờ" ? `<button onclick="duyetGiaoDich('${uid}')">Duyệt</button>` : '✔ Đã duyệt'}</td>
        </tr>`;
      }
      html += "</table>";
      document.getElementById("banggiaodich").innerHTML = html;
    });

    function duyetGiaoDich(uid) {
      database.ref("giaodich/" + uid + "/status").set("Thành công");
    }
  </script>
</body>
</html>
